---
layout: post_page
title: 【计算机】在Visual Studio 2008中使用Flex、Bison工具的配置
date: 2012-01-04 16:40:31
categories: 计算机
tags: [flex,bison,vs2008,配置]
---


写这篇文章是为了很多刚刚在vs2008下使用Flex、Bison工具的孩子。刚开始学Flex、Bison在编译运行的时候遇到问题，又Google不出答案，走很多弯路（我就是其中之一），于是在找到答案以后一定要写出来方便大家。

首先说一下我的情况，网上有些类似解决方法的描述不清不楚，看得很费力，还是一开始说清楚的好。

我下载的flex-2.5.4a-1.exe和bison-2.4.1.setup.exe安装包，两个软件的安装路径D:\GnuWin32。安装在哪个盘无所谓，但是安装路径中不能有空格。先安装flex再安装bison的时候会自动找到安装路径，不需修改。

1）打开vs2008，新建一个Win32控制台程序，不要预编译头，选择生成空项目；

2）配置大环境：工具-选项-项目和解决方案-VC++目录，在“可执行文件”目录下添加如你的flex和bison执行文件目录，就是安装目录下的bin文件夹。对于我来说就是D:\GnuWin32\bin，如图：



这个配置相当于配置系统的环境变量，flex和bison的命令在命令行下还是只能在“安装目录\bin”目录下才能执行，但是在vs2008中可以直接执行；

3）项目配置：项目-属性-配置属性-自定义生成步骤，其中附加依赖项一栏填上"安装目录\bin"，在我的机器上相当于"D:\GnuWin32\bin",如图：



这个操作就是告诉项目中的一些有自定义生成步骤的文件去哪里找命令执行文件，如flex -i -o
xxx.l命令在D:\GnuWin32\bin目录下执行这个命令；

项目-属性-配置属性-C/C++，附加包含目录一项写入"安装目录\include"，在我的机器上就是"D:\GnuWin32\include"，如图：



在编译执行flex和bison生成的cpp文件的时候，会有头文件unistd.h报错不存在，这个目录里就是unistd.h这个文件，这个操作就是告诉项目下的文件可以在这个目录中找到一些需要的文件；

上面两个操作都是有继承性的，所以一旦配置以后不需要对项目下的文件再做同样配置；

4）创建flex输入文件，flex对文件名和后缀没有要求，以lex.l为例。在解决方案资源管理器中选中这个文件，反键-属性-自定义生成步骤，
命令行：
"$(InputDir)$(InputName).cpp"
附加依赖项：不用填，上一步已经整体配置过了
如图：
这个操作就是配置flex处理的命令；

5）创建bison输入文件，bison输入文件的后缀为.y或.ypp，前者将生成.c文件，后者将生成.cpp文件，以bison.ypp为例。在解决方案资源管理器中选中这个文件，反键-属性-自定义生成步骤，










![](/imgs/b3f94a429cb72617b1f3b9509b6eac9495f67a6b.jpg)

6）调试这各项目或分别选中这两个文件进行编译都可以生成输出文件，在前文举的例子中lex.l文件输出为lex.cpp，bison.ypp文件输出为bison.tab.cpp和bison.tab.hpp。将bison.tab.hpp添加到项目头文件，lex.l和bison.tab.cpp添加到源文件中再执行一次项目就可以运行了。

如果编译出错的话可以在项目文件目录下Debug\BuildLog.htm查看详细的生成日志。

其实还有一个办法，可以再vs2008下使用flex和bison，这种方法比较简单，还是以我的机器为例。

我的电脑-反键-属性-高级-环境变量，编辑系统变量Path，在后面加上安装目录\bin，我机器上是D:\GnuWin32\bin，不要忘了用分号将前面的隔开=
=，编辑系统变量classpath，在后面加上安装目录\lib，在我的机器上就是D:\GnuWin32\lib，同样要用分号隔开。配置完这个，上面第一种方法说的那些步骤中除了第三步项目配置中的第二项有关unistd.h头文件目录的添加，其他的就都不需要了。

